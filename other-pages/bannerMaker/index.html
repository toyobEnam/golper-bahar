<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>News Image Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Kalpurush&display=swap" rel="stylesheet">

<style>
body{
  font-family: Kalpurush, Arial, sans-serif;
  background:#000;
  color:white;
  margin:0;
  padding:0;
}

/* Desktop center */
.app{
  min-height:100vh;
  display:grid;
  grid-template-columns: 1fr 1.2fr;
  max-width:1200px;
  margin:auto;
}

.panel{
  padding:20px;
}

.left{
  background:#0d0d0d;
}

.right{
  background:#141414;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
}

h2{
  font-size:22px;
  margin-bottom:15px;
  text-align:center;
}

input,button{
  padding:11px;
  margin:6px 0;
  width:100%;
  border-radius:8px;
  border:none;
  font-size:15px;
  box-sizing:border-box;
  font-family: Kalpurush, Arial;
}

input{
  background:#1a1a1a;
  color:white;
  border:1px solid #333;
}

button{
  background:#e63946;
  color:white;
  cursor:pointer;
}

button:hover{
  opacity:0.9;
}

.canvas-wrap{
  margin-top:10px;
  width:100%;
}

canvas{
  width:100%;
  height:auto;
  border:1px solid #444;
  display:block;
  border-radius:10px;
}

/* Mobile App style */
@media (max-width:1024px){
  .app{
    grid-template-columns:1fr;
  }

  .panel{
    padding:15px;
  }

  h2{
    font-size:20px;
  }

  button{
    font-size:16px;
    padding:13px;
  }
}
</style>
</head>

<body>

<div class="app">

<!-- LEFT PANEL -->
<div class="panel left">

<h2>News Thumbnail Generator</h2>

<input type="file" id="imgInput">
<input id="labelInput" placeholder="উপরের বাম লেখা লিখুন">
<input id="headline" placeholder="Headline লিখুন">
<input id="tagline" placeholder="Tagline লিখুন">

</div>

<!-- RIGHT PANEL -->
<div class="panel right">

<button id="generateBtn">Generate</button>
<button id="downloadBtn">Download (150KB)</button>

<div class="canvas-wrap">
<canvas id="canvas" width="1350" height="900"></canvas>
</div>

</div>

</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let baseImage=new Image();

document.getElementById("imgInput").addEventListener("change",e=>{
  const file=e.target.files[0];
  if(!file)return;
  baseImage.src=URL.createObjectURL(file);
});

function getBanglaDate(){
  const months=["জানুয়ারী","ফেব্রুয়ারী","মার্চ","এপ্রিল","মে","জুন","জুলাই","আগস্ট","সেপ্টেম্বর","অক্টোবর","নভেম্বর","ডিসেম্বর"];
  const d=new Date();
  return d.getDate()+" "+months[d.getMonth()]+", "+d.getFullYear();
}

document.getElementById("generateBtn").onclick=async ()=>{

  await document.fonts.load("60px Kalpurush");
  await document.fonts.load("58px Kalpurush");
  await document.fonts.load("32px Kalpurush");

  const headline=document.getElementById("headline").value;
  const tagline=document.getElementById("tagline").value;
  const labelText=document.getElementById("labelInput").value;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  const iw = baseImage.width;
  const ih = baseImage.height;
  const targetAspect = 16/9;

  let sw, sh, sx, sy;

  if(iw/ih > targetAspect){
    sh = ih;
    sw = ih * targetAspect;
    sx = (iw - sw) / 2;
    sy = 0;
  }else{
    sw = iw;
    sh = iw / targetAspect;
    sx = 0;
    sy = (ih - sh) / 2;
  }

  ctx.drawImage(baseImage, sx, sy, sw, sh, 0, 0, canvas.width, canvas.height);

  ctx.fillStyle="#b00000";
  ctx.fillRect(0, canvas.height-220, canvas.width, 220);

  const bannerTop = canvas.height - 220;
  const bannerMiddle = bannerTop + 110;

  ctx.textAlign="center";
  ctx.textBaseline="middle";

  ctx.fillStyle="white";
  ctx.font="bold 60px Kalpurush";
  ctx.fillText(headline, canvas.width/2, bannerMiddle-32.5);

  ctx.fillStyle="#ffe08a";
  ctx.font="bold 58px Kalpurush";
  ctx.fillText(tagline, canvas.width/2, bannerMiddle+32.5);

  ctx.textBaseline="alphabetic";

  const grad=ctx.createLinearGradient(0,0,0,45);
  grad.addColorStop(0,"rgba(0,0,0,0.85)");
  grad.addColorStop(1,"rgba(0,0,0,0.2)");

  ctx.font="32px Kalpurush";
  let tagWidth=ctx.measureText(labelText).width;
  ctx.fillStyle=grad;
  ctx.fillRect(15,15,tagWidth+30,45);
  ctx.fillStyle="white";
  ctx.textAlign="left";
  ctx.fillText(labelText,30,48);

  let dateText=getBanglaDate();
  let dateWidth=ctx.measureText(dateText).width;
  ctx.fillStyle=grad;
  ctx.fillRect(canvas.width-dateWidth-45,15,dateWidth+30,45);
  ctx.fillStyle="white";
  ctx.textAlign="right";
  ctx.fillText(dateText,canvas.width-30,48);
};

document.getElementById("downloadBtn").onclick=()=>{
  let quality=0.9;
  let dataURL;

  do{
    dataURL=canvas.toDataURL("image/jpeg",quality);
    quality-=0.05;
  }while(dataURL.length/1024>150 && quality>0.1);

  const a=document.createElement("a");
  a.href=dataURL;
  a.download="news-thumbnail.jpg";
  a.click();
};
</script>

</body>
</html>
